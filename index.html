<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Plane Financing Calculator</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" />
  <style>
    body { background-color: black; color: white; font-family: Arial, sans-serif; text-align: center; }
    #hot { margin: 20px auto; max-width: 95%; }
    .handsontable th { background-color: #333; color: white; }
    .htRight { text-align: right; }
  </style>
</head>
<body>
  <h1>Plane Financing Calculator</h1>
  <div id="hot"></div>

  <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hyperformula/dist/hyperformula.full.min.js"></script>
  <script>
    const container = document.getElementById('hot');

    const data = [
      ["Year", "Loan Balance", "Interest", "Plane Value", "Investment Value", "Tax Savings", "Net Cash Value", "Legacy Value"],
      [1, -5000000, -275000, 4750000, 20000000, 2000000, 0, 0],
      [2, -5000000, -275000, 4512500, 21600000, 2100000, 500000, 1000000],
      [3, -5000000, -275000, 4286875, 23328000, 2200000, 1000000, 2000000],
      [4, -5000000, -275000, 4072531, 25194240, 2300000, 1500000, 3000000],
      [5, -5000000, -275000, 3868904, 27209779, 2400000, 2000000, 4000000],
    ];

    const hfInstance = HyperFormula.buildEmpty({
      licenseKey: 'gpl-v3'
    });

    const hot = new Handsontable(container, {
      data,
      rowHeaders: false,
      colHeaders: true,
      formulas: { engine: hfInstance },
      licenseKey: 'non-commercial-and-evaluation',
      stretchH: 'all',
      width: '100%',
      height: 'auto',
      columns: [
        { type: 'numeric', numericFormat: { pattern: '0' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
        { type: 'numeric', numericFormat: { pattern: '$#,##0;($#,##0)' } },
      ]
    });
  </script>
</body>
</html>
